
$$f_{ε,u,v}(x) = v p(x) + u \|x\|^{d-1} ∫ f(x - ε v \|x\| t) s(t) dt  $$

\begin{eqnarray*}
  ∇f_{ε,u,v}(x) &=& v ∇p(x) + u (d-1) x \|x\|^{d-3} ∫ f(x - ε v \|x\| t) s(t)
  dt \cr
  && + u \|x\|^{d-1} ∫ ∇f(x - ε v \|x\| t) s(t) dt  \cr
 && - ε v u \|x\|^{d-2} ∫ ∇f(x - ε v \|x\| t)^tx t s(t) dt
\end{eqnarray*}

If $∇f = 0$, then $f = 0$ and
$$∫ f(x - ε v \|x\| t) s(t) dt = - \frac{v p(x)}{u \|x\|^{d-1}} $$

If $∇f = 0$, then
\begin{eqnarray*}
  ∇f_{ε,u,v}(x) &=& v ∇p(x) + v (d-1) x \|x\|^{-2} p(x)
  dt \cr
  && + u \|x\|^{d-1} ∫ ∇f(x - ε v \|x\| t) s(t) dt  \cr
 && - ε v u \|x\|^{d-2} ∫ ∇f(x - ε v \|x\| t)^tx t s(t) dt
\end{eqnarray*}


\begin{defi}
   Let $Δ = (Δᵢ)_{i∈I}$ be  a \emph{simplicial partition} of $\PNR$, a
   \emph{$Δ$-linear map}
   is a map $f : ℝ^{n+1} → ℝ$ which is continuous, piecewise linear and linear
on each $Δᵢ⁺$ and $Δᵢ⁻$ for $i ∈ I$.

  For such a map, and for all $i∈I$, we define $fᵢ⁺$ (resp. $fᵢ⁻$) the restriction of $f$ to
  $Δᵢ⁺$ (resp. $Δᵢ⁻$). We also define $∇fᵢ⁺$ (resp. $∇fᵢ⁻$) the gradient of
  $fᵢ⁺$ (resp. $fᵢ⁻$), which is constant as these functions are linear.


  For any point $x∈\SNR$, we define $$∇ᶜf(x) = \cone{\{∇fᵢσ, (i,σ) ∈ I_ε(x ∈ Δᵢ⁺\} ∪ \{∇fᵢ⁻, x ∈ Δᵢ⁻\}}$$

  And for $x∈\SNR$ and $ε > 0$, we define
\begin{eqnarray*}
  ∇ᶜ_εf(x) &=& \cone{\{∇fᵢ⁺, \ball{x}{ε}
    ∩ Δᵢ⁺ ≠ ∅\} ∪ \{∇fᵢ⁻, \ball{x}{ε} ∩ Δᵢ⁻ ≠ ∅\}} \cr
  &=& \cone{\{∇f^σᵢ, (i, σ) ∈ I_ε(x)\}}
\end{eqnarray*}

\end{defi}

Remarks:
\begin{itemize}
  \item if $x ∈ πₙ^{-1}(\interior{Δᵢ})$
    for some $i ∈ I$, then $∇ᶜf(x) = \{∇f(x)\}$.

 \item In this paper, we will only consider odd or even $Δ$-linear map, meaning that
   it exists $σ ∈ \{-1,1\}$ such that for all $i ∈ I$ we have $fᵢ⁺ = σ fᵢ⁻$. For
   such a map, the zero locus is well defined on $\PNR$.
\end{itemize}

\begin{defi}
  We say that a $Δ$-linear map $f$ is smooth if for all $x ∈ ℝ^{n+1}∖\{0\}$, $∇ᶜf(x)$
  does not contains the vector $0$.
\end{defi}

\begin{prop}\label{ghull}
  If $Δ = (Δᵢ)_{i∈I}$ is an $ε$-fat \emph{simplicial partition} for some $ε>0$
  and if $f$ is a $Δ$-linear map, then for any $x ∈
     \SNR$ there exists $y ∈
     \SNR$ such that $$∇ᶜf(x) ⊆ ∇ᶜ_εf(x) ⊆ ∇ᶜf(y).$$ Moreover, if $f$ is smooth, then $0 ∉ ∇ᶜ_εf(x)$.
\end{prop}

\begin{proof}
  $∇ᶜf(x) ⊆ ∇ᶜ_εf(x)$ comes from $I(x) ⊂ I_ε(x)$.
  Let use define $J = I_ε(x)$. By definition $∇ᶜ_εf(x) = \cone{\{∇ᵢ^σ, (i,σ) ∈
    J\}}$.
  As the simplicial partition is $ε$-fat, we can take $y ∈ ∩_{(i,σ)
    ∈ J} Δᵢ^σ ∩ \SNR$. Therefore, $J ⊂ \{(i,σ), y ∈ Δᵢ^σ\}$ which implies
  $∇ᶜ_εf(x) ⊆ ∇ᶜf(y)$. The last part is a direct consequence of the definition
  of $f$ smooth.
\end{proof}

\begin{prop}
  Let $Δ = (Δᵢ)_{i∈I}$ be a \emph{simplicial partition} of $\PNR$ and
  let $f$ be a smooth \emph{$Δ$-linear map}.
  For any $ε_M ∈ ]0,1[$ such that $Δ$ is $ε_M$-fat, there exists a family of $C^∞$ function
  $ε ↦ f_ε : ]0,ε_M] → \SNR → ℝ$ such that
  \begin{enumerate}
  \item $∀x ∈ \SNR, f(x) - f_ε(x) → 0$ when $ε → 0$
  \item $∀x ∈ \SNR, ∇f_ε(x) ∈ ∇ᶜ_εf(x)$ and $∇f_ε(x) ≠ 0$.
  \item All functions $f_ε$ and $f$ have homeomorphic zero locus.
  \end{enumerate}
\end{prop}

\begin{proof} We first start with few notations:
  \begin{itemize}
  \item Let $s:ℝ^{n+1} → ℝ⁺$ a $C^∞$ map with support included in $B_1(0)$ and such
  that $∫_{ℝ^{n+1}} s(t)dt = 1$ for the usual measure $dt$ of $ℝ^{n+1}$. We also
  assume that $s(-x) = s(x)$.

  \item We define $s_ε(x) = ε^{-n-1}s(ε^{-1} x)$, which has support in $B_ε(0)$ and
  satisfies $∫_{ℝ^{n+1}} s_\epsilon(t)dt = 1$ because
  \begin{eqnarray*}
    ∫_{ℝ^{n+1}} s_\epsilon(t)dt &=& ∫_{ℝ^{n+1}} ε^{-n-1}s(ε^{-1}t)dt \cr
    &=& ∫_{ℝ^{n+1}} s(u)du \hbox{ using } t = εu, dt = ε^{n+1}du \cr
    &=& 1
  \end{eqnarray*}
  \end{itemize}


  We define $f_ε= f ∗ s_ε$: $$f_ε(x) = ∫_{ℝ^{n+1}} f(x-t)s_ε(t) dt = ∫_{ℝ^{n+1}}
  f(x-ε u)s(u) du.$$

  From the properties of convolution product we known that $f_ε$ is $C^∞$ on
  $\SNR$. For the limit:
  \begin{eqnarray*}
    |f(x) - f_ε(x)| &=& \left|∫_{ℝ^{n+1}} (f(x) - f(t))s_{ε}(x-t) dt\right|\cr
    &<& \max_{t∈B_ε(x)} |f(x) - f(t)| → 0  \hbox{ when } ε → 0\cr
    && \hbox{because $f$ is continuous.}
  \end{eqnarray*}

  We also define $\Psi_i^σ(x,ε) = \{ t ∈ \ball{0}{ε}, x - t ∈ Δᵢ^σ \}$

  For the gradient, using the fact that $f$ is $C¹$ almost every where and that
  $|∇f(x)|$ is bounded, we have
  \begin{eqnarray*}
    ∇f_ε(x) &=& ∇∫_{ℝ^{n+1}} f(x-t)s_{ε}(t) dt\cr
    &=& ∫_{ℝ^{n+1}} ∇f(x-t)s_{ε}(t) dt\cr
    &=& Σ_{(i,σ)∈I_ε(x)}∫_{\Psi_i^σ(x,ε)} ∇f(x-t)s_{ε}(t) dt\cr
    &=& Σ_{(i,σ)∈I_ε(x)} λᵢ(ε) ∇ᵢ^σf
    \hbox{ with } λᵢ(ε) = ∫_{\Psi_i^σ(x,ε)} s_{ε}(t) dt > 0
  \end{eqnarray*}


  Hence $∇f_ε(x)$ is in $∇ᶜ_εf(x)$ and hence non zero by proposition
  \ref{ghull} because
  $$Σ_{(i,σ)∈I_ε(x)} λᵢ(ε) = Σ_{i∈V_ε(x)}∫_{\Psi_i^σ(x,ε)} s_ε(t) dt =
  ∫_{\ball{0}{ε}} s_ε(t) dt = 1$$


  Moreover, we have
  \begin{eqnarray*}
    λᵢ(ε) &=&  ∫_{\Psi_i^σ(x,ε)} s_{ε}(t) dt \cr
    &=& ∫_{\Phi_i^σ(x,ε)} s(u) du
    \hbox{ with } \Phi_i^σ(x,ε) = \{ u ∈ \ball{0}{1}, x - εu ∈ Δᵢ^σ\}
  \end{eqnarray*}

  Now, if $ε$ is small enough to have $I(x) = I_ε(x)$, then $\Phi_i^σ(x,ε)$ also
  becomes independant of $ε$.  As a consequence, $∇f_ε(x)$ is constant for $ε$
  small enough, hence convergent to a value which is in $∇ᶜf(x)$ and therefore
  non zero. Therefore,
  we define $∇₀f(x)$ the limit of $∇f_ε(x)$.

  To build the homeomorphism between the various zero levels, we consider the
  following differential equation on for $γ(ε) : ℝ ↦ ℝ^{n+1}$:

  $$ γ'(ε) = g(ε,γ(ε)) \hbox{ with } g(ε,x) = - \frac{∂f_ε}{∂ε}(x) \frac{∇f_ε(x)}{||∇f_ε(x)||²} $$

  The function $g$ is ${\cal
    C}^∞$ for $0 < ε < ε_M$ and $x ∈ \SNR$ because $∇f_ε(x) ≠ 0$.
   We need to show that it can be
  prolongated to $ε = 0$. As we already have seen how to prolongate $∇f_ε(x)$ to
  a non zero value, we only have to examine the limit of $\frac{∂f_ε(x)}{∂ε}$.


  \begin{eqnarray*}
    \frac{∂f_ε(x)}{∂ε} &=& \frac{∂}{∂ε} ∫_{ℝ^{n+1}} f(x - ε u)s(u) du \cr
        &=& - ∫_{ℝ^{n+1}} ∇f(x - ε u).u s(u) du \cr
    &=& - Σ_{(i,σ)∈I_ε(x)} ∇ᵢ^σf. ∫_{\Phiᵢ^σ(x,ε)}  u s(u) du\cr
  \end{eqnarray*}

  For that same reason as above, the vector $∫_{\Phiᵢ^σ(x,ε)}  u s(u) du$
  is constant for   $ε$ is small enough. Hence $\frac{∂f_ε(x)}{∂ε}$ has a limit for $ε → 0$.

   Hence, by Cauchy-Lipschitz theorem, the above differential equation has
   a unique solution with $γ_{x₀}(ε) = x₀$ for $ε in [0,ε_M]$. Moreover $f_ε(γ(ε))$ is constant
   because
   \begin{eqnarray*}
    \frac{∂f_ε(γ_{x₀}(ε)}{∂ε} &=& \frac{∂}{∂ε} f_ε(γ_{x₀}(ε)) +
    ∇f_ε(γ_{x₀}(ε)).g(ε,γ_{x₀}(ε)) \cr
    &=& 0
   \end{eqnarray*}

   This means that $γ_{x₀}$ gives an homeomorphism between the zero locus of $f$
   and $f_ε$.
\end{proof}

\section{Polynomials and $Δ$-linear map}

  \begin{defi}
    Let $P$ be an homogeneous polynomial in $n+1$ variables.
    Let $(Δᵢ)_{i∈I}$ be a simplicial partition of $\PNR$. We define $f_P$ the
    piecewise linear map that coincides with $P$ on every summit of $Δ$.

    $(Δᵢ)_{i∈I}$ is $P$-thin if for any $i₁,\dots,iₖ ∈ I$ such that $Δ_{i₁} ∩
    \dots ∩ Δ_{iₖ} ≠ ∅$, the convex hull of
    $$ G_{i₁,\dots,iₖ} = \{ ∇ⱼ f_P, j = i₁,\dots,iₖ \} ∪ \{ ∇P(x), x ∈ Δ_{i₁} ∩
    \dots ∩ Δ_{iₖ} \}$$
    does not contain the vector $0$.
  \end{defi}


  \begin{prop}
    Let $P$ be an homogeneous polynomial in $n+1$ variables.
    Let $(Δᵢ)_{i∈I}$ be a $P$-thin simplicial partition of $\PNR$. Then the zero
    locus of $f_P$ and $P$ are homeomorphic.
  \end{prop}

  \begin{proof}
    Let $ε_M$ such that $(Δᵢ)_{i∈I}$ is $ε_M$ fat. For $(t,ε) ∈ [0,1] ×
    [0,ε_M]$, let $f_{t,ε} = (1-t) P + t f_ε$.
  \end{proof}
