\section{Testing zero in convex hull}

The central test in our algorith is to know if the null vector is in the convex
hull of a given set of vector of $ℝ^d$, or as it is clearly equivalent, in its convex
cone.

More precisely, the problem we want to solve can be defined as follows:
\begin{defi}
  \begin{tabular}{ll}
  Input:& a real $n × d$ matrix $A$. \cr
  Output:& a non nul vector $X ∈ ℝ_+^n$ such that $^tX A = 0$ \cr
  or& a vector $N ∈ ℝ^d$ such that $A N > 0$
  \end{tabular}
\end{defi}

This does correspond to our problem: if zero is in the convex hull of the lines
of the matrix $A$, then we can produce the wanted vector $X∈ ℝ_+^n$. It zero is not in
the convex hull, then we can return the normal $N∈ ℝ^d$ of a linear plane such that
all the lines of $A$ lie on the same side of this plane.

We start the algorithm with an initial vector $X_0∈ ℝ_+^n$, with positive coefficients
summing to one, for instance $X₀=\frac{1}{n}ᵗ(1,1,\dots,1,1)$.
We define $N_i = tX_i A$. We also define a vector $P_0 = 0 ∈ ℝ_+^n $.

The algorithm then perform two kind of steps:

\paragraph*{Conjugate steps}, which are somehow inspired by the conjugate
gradient method.

First we define $J ∈ ℝ_+^n = (1,1,\dots,1,1)$ and $ν(X) = \frac{1}{J.X} X$ which
normalise the vector $X$ to have all its coefficient sum to one. We will use
$ν(X)$ only one non null vector in $ℝ_+^n$.

If for all lines $Aⱼ$ of $A$ we have $Aⱼ.Nᵢ > 0$ then the algorithm
stops and output $N = Nᵢ$. Otherwise we select $Dᵢ = δⱼ$ such that $Aⱼ.Nᵢ ≤ 0$ and minimum.
Then we compute $α>0,β ∈ ℝ$, $X_{i+1} = ν(Xᵢ + αDᵢ+βPᵢ)$, such that
  $\|ᵗX_{i+1} A\|²$ is minimum. We have
  \begin{eqnarray*}
    f(α,β) &=& \|ᵗX_{i+1} A\|² \cr
    &=& \frac{\|ᵗXᵢ A + αᵗDᵢA + βᵗPᵢA\|²}{(1 + α + β)²}\cr
    &=& \frac{\|Nᵢ + αᵗAⱼ + βᵗPᵢA\|²}{(1 + α + βPᵢ.J)²}\cr
    &=& \frac{\|Nᵢ\|² + α² + β²\|ᵗPᵢA\|² + 2 α Nᵢ.Aⱼ + 2 β Nᵢ.ᵗPᵢA + 2αβ Aⱼ.ᵗPᵢA}
    {1 + α² + β²(Pᵢ.J)² + 2α + 2βPᵢ.J + 2αβPᵢJ}\cr
    \frac{∂f(α,β)}{∂α}
    &=& \frac{\begin{array}{cl}
        &(2α + 2 Nᵢ.Aⱼ + 2βAⱼ.ᵗPᵢA)(1 + α² + β²(Pᵢ.J)² + 2α + 2βPᵢ.J + 2αβPᵢJ)\cr
        - &(\|Nᵢ\|² + α² + β²\|ᵗPᵢA\|² + 2 α Nᵢ.Aⱼ + 2 β Nᵢ.ᵗPᵢA + 2αβ
      Aⱼ.ᵗPᵢA)(2α + 2 + 2βPᵢJ)
      \end{array}}{(1 + α² + β²(Pᵢ.J)² + 2α + 2βPᵢ.J + 2αβPᵢJ)²}\cr
    &=&
    {(1 + α² + β²(Pᵢ.J)² + 2α + 2βPᵢ.J + 2αβPᵢJ)²}\cr
  \end{eqnarray*}
